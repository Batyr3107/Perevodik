#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ç–æ—Ä —Å—Ç–∏–ª—è –¥–ª—è –≤–µ–±-–Ω–æ–≤–µ–ª–ª
–ü—Ä–∏–∑–µ–º–ª—è–µ—Ç –≤—ã—Å–æ–∫–æ–ø–∞—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–æ —É—Ä–æ–≤–Ω—è "—á–∏—Ç–∞–µ—Ç—Å—è –≤ –º–µ—Ç—Ä–æ"
"""

import re
from typing import Dict, List, Tuple

class StyleModernizer:
    """–ü—Ä–∏–∑–µ–º–ª—è–µ—Ç –≤—ã—Å–æ–∫–æ–ø–∞—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è"""
    
    def __init__(self):
        # –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–º–µ–Ω—ã –∞—Ä—Ö–∞–∏–∑–º–æ–≤
        self.basic_replacements = {
            # –ê—Ä—Ö–∞–∏–∑–º—ã
            "–≤–æ–∑–∑—Ä–µ–ª": "–ø–æ—Å–º–æ—Ç—Ä–µ–ª",
            "–º–æ–ª–≤–∏–ª": "—Å–∫–∞–∑–∞–ª", 
            "–≤–æ–ø—Ä–æ—à–∞–ª": "—Å–ø—Ä–∞—à–∏–≤–∞–ª",
            "–≤–µ—Å—å–º–∞": "–æ—á–µ–Ω—å",
            "—á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ": "–æ—á–µ–Ω—å",
            "–¥–∞–±—ã": "—á—Ç–æ–±—ã",
            "–∏–±–æ": "–ø–æ—Ç–æ–º—É —á—Ç–æ",
            "—Å–µ–π": "—ç—Ç–æ—Ç",
            "—Å–∏—è": "—ç—Ç–∞", 
            "–æ–Ω—ã–π": "—Ç–æ—Ç",
            "–Ω—ã–Ω–µ": "—Å–µ–π—á–∞—Å",
            "–æ—Ç–Ω—é–¥—å": "—Å–æ–≤—Å–µ–º –Ω–µ",
            "–Ω–µ–ø—Ä–µ–º–µ–Ω–Ω–æ": "–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ",
            "–≤–æ–∏—Å—Ç–∏–Ω—É": "–ø—Ä–∞–≤–¥–∞",
            "–æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å": "–¥–µ–ª–∞—Ç—å",
            "–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ": "–≤–ø–µ—á–∞—Ç–ª—è—Ç—å",
            "–∏—Å–ø—ã—Ç—ã–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–æ": "—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å",
            
            # –ö—É–ª—å—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã (—É–ø—Ä–æ—â–∞–µ–º)
            "–ø–æ—Å—Ç–∏—á—å –î–∞–æ": "–ø–æ–Ω—è—Ç—å –î–∞–æ",
            "—Å–Ω–∏—Å–∫–∞—Ç—å –º–∏–ª–æ—Å—Ç—å": "–ø–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ", 
            "—è–≤–∏—Ç—å –º–æ–≥—É—â–µ—Å—Ç–≤–æ": "–ø–æ–∫–∞–∑–∞—Ç—å —Å–∏–ª—É",
            "–≤–æ–∑–Ω–µ—Å—Ç–∏ —Ö–≤–∞–ª—É": "–ø–æ—Ö–≤–∞–ª–∏—Ç—å",
            "–ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å –Ω–µ–±–µ—Å–Ω—É—é –∫–∞—Ä—É": "–ø—Ä–æ–π—Ç–∏ –Ω–µ–±–µ—Å–Ω—É—é –∫–∞—Ä—É",
            "–≤—Å—Ç—É–ø–∏—Ç—å –≤ —Å—Ö–≤–∞—Ç–∫—É": "–Ω–∞—á–∞—Ç—å –±–æ–π",
            "–ø–æ—Ç–µ—Ä–ø–µ—Ç—å –ø–æ—Ä–∞–∂–µ–Ω–∏–µ": "–ø—Ä–æ–∏–≥—Ä–∞—Ç—å",
            
            # –≠–º–æ—Ü–∏–∏ –∏ —Ä–µ–∞–∫—Ü–∏–∏
            "–ø—Ä–µ–∏—Å–ø–æ–ª–Ω–∏–ª—Å—è –≥–Ω–µ–≤–æ–º": "—Ä–∞–∑–æ–∑–ª–∏–ª—Å—è",
            "–≤–ø–∞–ª –≤ —è—Ä–æ—Å—Ç—å": "–≤–∑–±–µ—Å–∏–ª—Å—è", 
            "–æ—â—É—Ç–∏–ª —Ç—Ä–µ–ø–µ—Ç": "–∏—Å–ø—É–≥–∞–ª—Å—è",
            "–≤–æ—Å–ø—ã–ª–∞–ª —Å—Ç—Ä–∞—Å—Ç—å—é": "–≤–ª—é–±–∏–ª—Å—è",
            "–ø–æ–≥—Ä—É–∑–∏–ª—Å—è –≤ —Ä–∞–∑–¥—É–º—å—è": "–∑–∞–¥—É–º–∞–ª—Å—è",
            "–∏–∑–¥–∞–ª –≤–∑–¥–æ—Ö": "–≤–∑–¥–æ—Ö–Ω—É–ª",
            
            # –°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            "–û–ø–æ–≤–µ—â–µ–Ω–∏–µ:": "–î–∏–Ω—å!",
            "–í—ã —É–¥–æ—Å—Ç–æ–µ–Ω—ã": "–ü–æ–ª—É—á–µ–Ω–æ",
            "–Ω–∞–≥—Ä–∞–¥—ã:": "–Ω–∞–≥—Ä–∞–¥–∞:",
            "–±–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏–µ:": "–Ω–∞–≥—Ä–∞–¥–∞:",
            "–Ω–∏—Å–ø–æ—Å–ª–∞–ª–∞": "–¥–∞–ª–∞",
            "–¥–∞—Ä—É–µ—Ç—Å—è": "–ø–æ–ª—É—á–µ–Ω–æ",
        }
        
        # –ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ –∞—Ä—Ö–∞–∏–∑–º—ã (–ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±–∏—Ä–∞–µ–º)
        self.banned_archaisms = [
            "—Å–µ–π", "—Å–∏—è", "–æ–Ω—ã–π", "–¥–∞–±—ã", "–∏–±–æ",
            "–≤–æ–∏—Å—Ç–∏–Ω—É", "–≤–µ—Å—å–º–∞", "–æ—Ç–Ω—é–¥—å", "–Ω–µ–ø—Ä–µ–º–µ–Ω–Ω–æ",
            "–º–æ–ª–≤–∏—Ç—å", "–≤–æ–∑–∑—Ä–µ—Ç—å", "–≤–æ–ø—Ä–æ—à–∞—Ç—å", "–Ω—ã–Ω–µ"
        ]
        
        # –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–º–µ–Ω—ã –¥–ª—è –º–æ–ª–æ–¥—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        self.youth_slang = {
            "–æ—á–µ–Ω—å –º–æ—â–Ω—ã–π": "–∫—Ä—É—Ç–æ–π",
            "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ": "—Ä–µ–∞–ª—å–Ω–æ", 
            "–ø—Ä–µ–∫—Ä–∞—Å–Ω–æ": "—Ç–æ–ø–æ–≤–æ",
            "—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ": "–ø—Ä–∏–∫–æ–ª—å–Ω–æ",
            "—Å—Ç—Ä–∞—à–Ω–æ": "–∂—ë—Å—Ç–∫–æ",
            "–±—ã—Å—Ç—Ä–æ": "–±—ã—Å—Ç—Ä–æ –∫–∞–∫ –º–æ–ª–Ω–∏—è",
            "—Å–∏–ª—å–Ω—ã–π": "–º–æ—â–Ω—ã–π",
            "–∫—Ä–∞—Å–∏–≤—ã–π": "–∫—Ä–∞—Å–∏–≤—ã–π –∫–∞–∫ –±–æ–≥"
        }
        
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        self.max_sentence_length = 15
        
    def modernize_text(self, text: str, character_age: str = "adult") -> str:
        """–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –¥–ª—è –≤–µ–±-–Ω–æ–≤–µ–ª–ª—ã"""
        
        # 1. –ó–∞–º–µ–Ω—è–µ–º –∞—Ä—Ö–∞–∏–∑–º—ã
        modernized = self._replace_archaisms(text)
        
        # 2. –£–ø—Ä–æ—â–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        modernized = self._simplify_sentences(modernized)
        
        # 3. –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–ª–µ–Ω–≥ –¥–ª—è –º–æ–ª–æ–¥—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        if character_age in ["young", "teen", "student"]:
            modernized = self._apply_youth_slang(modernized)
            
        # 4. –£–ª—É—á—à–∞–µ–º –¥–∏–∞–ª–æ–≥–∏
        modernized = self._modernize_dialogue(modernized)
        
        # 5. –£–ø—Ä–æ—â–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏—è
        modernized = self._simplify_descriptions(modernized)
        
        return modernized
    
    def _replace_archaisms(self, text: str) -> str:
        """–ó–∞–º–µ–Ω—è–µ—Ç –∞—Ä—Ö–∞–∏–∑–º—ã –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞"""
        for old, new in self.basic_replacements.items():
            text = text.replace(old, new)
        return text
    
    def _simplify_sentences(self, text: str) -> str:
        """–†–∞–∑–±–∏–≤–∞–µ—Ç –¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ"""
        sentences = re.split(r'[.!?]+', text)
        result = []
        
        for sentence in sentences:
            sentence = sentence.strip()
            if not sentence:
                continue
                
            words = sentence.split()
            if len(words) > self.max_sentence_length:
                # –†–∞–∑–±–∏–≤–∞–µ–º –¥–ª–∏–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                parts = self._split_long_sentence(sentence)
                result.extend(parts)
            else:
                result.append(sentence)
        
        return '. '.join(result) + '.'
    
    def _split_long_sentence(self, sentence: str) -> List[str]:
        """–†–∞–∑–±–∏–≤–∞–µ—Ç –¥–ª–∏–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–∏"""
        words = sentence.split()
        if len(words) <= self.max_sentence_length:
            return [sentence]
        
        # –ò—â–µ–º –º–µ—Å—Ç–æ –¥–ª—è —Ä–∞–∑—Ä—ã–≤–∞ (—Å–æ—é–∑—ã, –∑–∞–ø—è—Ç—ã–µ)
        break_points = []
        for i, word in enumerate(words):
            if word.lower() in ['–∏', '–∞', '–Ω–æ', '—á—Ç–æ', '–∫–æ—Ç–æ—Ä—ã–π', '–≥–¥–µ', '–∫–æ–≥–¥–∞']:
                break_points.append(i)
        
        if not break_points:
            # –†–∞–∑–±–∏–≤–∞–µ–º –ø–æ–ø–æ–ª–∞–º
            mid = len(words) // 2
            part1 = ' '.join(words[:mid])
            part2 = ' '.join(words[mid:])
            return [part1, part2]
        
        # –†–∞–∑–±–∏–≤–∞–µ–º –≤ –ª—É—á—à–µ–º –º–µ—Å—Ç–µ
        best_break = min(break_points, key=lambda x: abs(x - len(words) // 2))
        part1 = ' '.join(words[:best_break])
        part2 = ' '.join(words[best_break:])
        return [part1, part2]
    
    def _apply_youth_slang(self, text: str) -> str:
        """–ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–æ–ª–æ–¥—ë–∂–Ω—ã–π —Å–ª–µ–Ω–≥"""
        for old, new in self.youth_slang.items():
            text = text.replace(old, new)
        return text
    
    def _modernize_dialogue(self, text: str) -> str:
        """–£–ª—É—á—à–∞–µ—Ç –¥–∏–∞–ª–æ–≥–∏"""
        # –£–±–∏—Ä–∞–µ–º –∏–∑–ª–∏—à–Ω—é—é –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å
        dialogue_replacements = {
            "–ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ": "–î–∞–π –º–Ω–µ",
            "–ù–µ —Å–æ–±–ª–∞–≥–æ–≤–æ–ª–∏—Ç–µ –ª–∏ –≤—ã": "–ù–µ –º–æ–≥–ª–∏ –±—ã –≤—ã",
            "–û—Å–º–µ–ª—é—Å—å —Å–ø—Ä–æ—Å–∏—Ç—å": "–ú–æ–∂–Ω–æ —Å–ø—Ä–æ—Å–∏—Ç—å?",
            "–°–∏–µ –¥–µ—è–Ω–∏–µ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ": "–¢–∞–∫ –Ω–µ–ª—å–∑—è",
            "–í–æ–∏—Å—Ç–∏–Ω—É –º–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π": "–†–µ–∞–ª—å–Ω–æ –º–æ—â–Ω—ã–π",
            "–Ø —Ö–æ—Ç–µ–ª –±—ã": "–•–æ—á—É",
            "–ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ": "–ü–æ—Ö–æ–∂–µ",
            "–Ø –±–æ—é—Å—å, —á—Ç–æ": "–ë–æ—é—Å—å",
            "–ß—Ç–æ —Ç—ã –¥—É–º–∞–µ—à—å –æ": "–ö–∞–∫ —Ç–µ–±–µ",
            "–Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é": "–ù–µ –ø–æ–Ω–∏–º–∞—é",
            "–≠—Ç–æ –Ω–µ —Ç–æ, —á—Ç–æ —è –∏–º–µ–ª –≤ –≤–∏–¥—É": "–ù–µ —Ç–æ –∏–º–µ–ª –≤ –≤–∏–¥—É",
            "–Ø –Ω–µ –º–æ–≥—É –ø–æ–≤–µ—Ä–∏—Ç—å": "–ù–µ –≤–µ—Ä—é"
        }
        
        for old, new in dialogue_replacements.items():
            text = text.replace(old, new)
        
        return text
    
    def _simplify_descriptions(self, text: str) -> str:
        """–£–ø—Ä–æ—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è"""
        # –£–±–∏—Ä–∞–µ–º –∏–∑–ª–∏—à–Ω–∏–µ —ç–ø–∏—Ç–µ—Ç—ã
        description_patterns = [
            (r'–≥–ª—É–±–æ—á–∞–π—à–∏–º\s+', ''),
            (r'–Ω–µ–ø–æ—Å—Ç–∏–∂–∏–º—ã–º–∏\s+', ''),
            (r'–±–µ–∑–¥–æ–Ω–Ω—ã–º\s+', ''),
            (r'–≤—Å–µ–ø–æ–≥–ª–æ—â–∞—é—â–∏–º\s+', ''),
            (r'–Ω–µ–æ–±—ä—è—Ç–Ω—ã–º\s+', ''),
            (r'–Ω–µ–∏—Å—á–µ—Ä–ø–∞–µ–º—ã–º\s+', ''),
        ]
        
        for pattern, replacement in description_patterns:
            text = re.sub(pattern, replacement, text, flags=re.IGNORECASE)
        
        return text
    
    def modernize_character_thoughts(self, text: str, character: str) -> str:
        """–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä—É–µ—Ç –º—ã—Å–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"""
        if character == "Jiang_Chen":
            # –¶–∑—è–Ω –ß—ç–Ω—å - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –≥—Ä—É–±–æ–≤–∞—Ç—ã–π
            thoughts_replacements = {
                "–ù–µ—É–∂–µ–ª–∏": "–°–µ—Ä—å—ë–∑–Ω–æ?",
                "–î–æ–ª–∂–µ–Ω –ª–∏ —è": "–ú–Ω–µ —á—Ç–æ,",
                "—Å–º–∏—Ä–∏—Ç—å—Å—è —Å —Ä–æ–ª—å—é": "–±—ã—Ç—å",
                "–ø—Ä–µ–∑—Ä–µ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–∞–ª–∏–º–∞": "–ø–æ–¥—Ö–∞–ª–∏–º–æ–º",
                "–î–∞ –ø–æ—à–ª–æ –æ–Ω–æ –≤—Å—ë": "–î–∞ –Ω—É –Ω–∞—Ñ–∏–≥",
                "–Ω–µ –±—É–¥—É —è –±–æ–ª—å—à–µ": "–Ω–µ –±—É–¥—É",
                "–ø–æ–¥–ª–∏–∑—ã–≤–∞—Ç—å—Å—è": "–ø–æ–¥–ª–∏–∑—ã–≤–∞—Ç—å—Å—è",
                "–±–µ–∑–º–æ–∑–≥–ª–∞—è –¥–µ–≤–∞": "–¥—É—Ä–æ—á–∫–∞",
                "–≤–Ω–æ–≤—å —è–≤–ª—è–µ—Ç —Å–≤–æ—é –≥–ª—É–ø–æ—Å—Ç—å": "–æ–ø—è—Ç—å —Ç—É–ø–∏—Ç",
                "–Ω–µ —Å–ø–æ—Å–æ–±–Ω–∞ —É–∑—Ä–µ—Ç—å –æ—á–µ–≤–∏–¥–Ω–æ–µ": "–Ω–µ –≤–∏–¥–∏—Ç –æ—á–µ–≤–∏–¥–Ω–æ–≥–æ",
                "–í–æ–∏—Å—Ç–∏–Ω—É, —Ç–µ—Ä–ø–µ–Ω–∏–µ –º–æ—ë –Ω–∞ –∏—Å—Ö–æ–¥–µ": "–ë–ª–∏–Ω, –∫–∞–∫ –∂–µ –±–µ—Å–∏—Ç",
                "–°–∏—è": "–≠—Ç–∞",
                "–±–µ–∑–º–æ–∑–≥–ª–∞—è": "–¥—É—Ä–∞—Ü–∫–∞—è"
            }
        elif character == "Ye_Qingcheng":
            # –ï –¶–∏–Ω—á—ç–Ω - –±–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–∞—è, –Ω–æ –Ω–µ –∞—Ä—Ö–∞–∏—á–Ω–∞—è
            thoughts_replacements = {
                "–ù–µ—É–∂–µ–ª–∏": "–ù–µ—É–∂–µ–ª–∏",
                "–î–æ–ª–∂–µ–Ω –ª–∏ —è": "–ú–Ω–µ —á—Ç–æ",
                "—Å–º–∏—Ä–∏—Ç—å—Å—è —Å —Ä–æ–ª—å—é": "–±—ã—Ç—å",
                "–ø—Ä–µ–∑—Ä–µ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–∞–ª–∏–º–∞": "–ø–æ–¥—Ö–∞–ª–∏–º–æ–º"
            }
        else:
            thoughts_replacements = {}
        
        for old, new in thoughts_replacements.items():
            text = text.replace(old, new)
        
        return text
    
    def modernize_system_notifications(self, text: str) -> str:
        """–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"""
        system_replacements = {
            "–û–ø–æ–≤–µ—â–µ–Ω–∏–µ: –ó–∞ —É—Å–ø–µ—à–Ω–æ–µ —É–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏": "–î–∏–Ω—å! –ó–∞ —É—Å–ø–µ—à–Ω–æ–µ –±–µ–∑–¥–µ–ª—å–µ",
            "–í—ã —É–¥–æ—Å—Ç–æ–µ–Ω—ã –Ω–∞–≥—Ä–∞–¥—ã:": "–ü–æ–ª—É—á–µ–Ω–æ:",
            "–±–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏–µ:": "–Ω–∞–≥—Ä–∞–¥–∞:",
            "–Ω–∏—Å–ø–æ—Å–ª–∞–ª–∞": "–¥–∞–ª–∞",
            "–¥–∞—Ä—É–µ—Ç—Å—è": "–ø–æ–ª—É—á–µ–Ω–æ",
            "–°–≤—è—â–µ–Ω–Ω–∞—è –¢–µ—Ö–Ω–∏–∫–∞": "–°–≤—è—â–µ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞",
            "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–æ–µ –û—Ä—É–¥–∏–µ": "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–æ–µ –æ—Ä—É–∂–∏–µ",
            "–í—Å–µ–Ω–µ–±–µ—Å–Ω–æ–µ –ó–µ—Ä–∫–∞–ª–æ": "¬´–í—Å–µ–Ω–µ–±–µ—Å–Ω–æ–µ –ó–µ—Ä–∫–∞–ª–æ¬ª",
            "–í—Å–µ–ª–µ–Ω–Ω–∞—è –≤ –î–ª–∞–Ω–∏": "¬´–í—Å–µ–ª–µ–Ω–Ω–∞—è –≤ –õ–∞–¥–æ–Ω–∏¬ª"
        }
        
        for old, new in system_replacements.items():
            text = text.replace(old, new)
        
        return text
    
    def calculate_readability_score(self, text: str) -> Dict[str, float]:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏"""
        sentences = re.split(r'[.!?]+', text)
        words = text.split()
        
        # –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        avg_sentence_length = len(words) / len(sentences) if sentences else 0
        
        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä—Ö–∞–∏–∑–º–æ–≤
        archaism_count = sum(1 for archaism in self.banned_archaisms 
                           if archaism in text.lower())
        
        # –ü—Ä–æ—Ü–µ–Ω—Ç –¥–ª–∏–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
        long_sentences = sum(1 for sentence in sentences 
                           if len(sentence.split()) > self.max_sentence_length)
        long_sentence_percentage = (long_sentences / len(sentences)) * 100 if sentences else 0
        
        # –û—Ü–µ–Ω–∫–∞ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ (0-100, –≥–¥–µ 100 = –æ—á–µ–Ω—å –ª–µ–≥–∫–æ)
        readability_score = 100 - (avg_sentence_length * 2) - (archaism_count * 5) - (long_sentence_percentage * 0.5)
        readability_score = max(0, min(100, readability_score))
        
        return {
            "readability_score": readability_score,
            "avg_sentence_length": avg_sentence_length,
            "archaism_count": archaism_count,
            "long_sentence_percentage": long_sentence_percentage
        }

def test_style_modernizer():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ç–æ—Ä–∞ —Å—Ç–∏–ª—è"""
    print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–¢–ò–õ–¨-–ú–û–î–ï–†–ù–ò–ó–ê–¢–û–†–ê")
    print("=" * 50)
    
    modernizer = StyleModernizer()
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã
    test_cases = [
        {
            "text": "–¶–∑—è–Ω –ß—ç–Ω—å –≤–æ–∑–∑—Ä–µ–ª –Ω–∞ –ø—Ä–æ—Å—Ç–∏—Ä–∞—é—â–∏–µ—Å—è –ø—Ä–µ–¥ –Ω–∏–º –ø—Ä–æ—Å—Ç–æ—Ä—ã –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ–π –°–≤—è—Ç–æ–π –ó–µ–º–ª–∏, –∏ —Å–µ—Ä–¥—Ü–µ –µ–≥–æ –ø—Ä–µ–∏—Å–ø–æ–ª–Ω–∏–ª–æ—Å—å –≥–ª—É–±–æ—á–∞–π—à–∏–º –ø—Ä–µ–∑—Ä–µ–Ω–∏–µ–º –∫ —Å–µ–π —é–¥–æ–ª–∏ –ø–æ–¥—Ö–∞–ª–∏–º—Å—Ç–≤–∞.",
            "character": "Jiang_Chen",
            "expected": "—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å"
        },
        {
            "text": "–û–ø–æ–≤–µ—â–µ–Ω–∏–µ: –ó–∞ —É—Å–ø–µ—à–Ω–æ–µ —É–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –í—ã —É–¥–æ—Å—Ç–æ–µ–Ω—ã –Ω–∞–≥—Ä–∞–¥—ã: –ò–º–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–æ–µ –û—Ä—É–¥–∏–µ –í—Å–µ–Ω–µ–±–µ—Å–Ω–æ–µ –ó–µ—Ä–∫–∞–ª–æ",
            "character": "System",
            "expected": "–∏–≥—Ä–æ–≤–æ–π —Å—Ç–∏–ª—å"
        },
        {
            "text": "–ú–ª–∞–¥—à–∞—è —Å–µ—Å—Ç—Ä–∞ –ï, –ø—Ä–æ—à—É –≤–∞—Å –Ω–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –º–æ–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º, –∏–±–æ –Ω–∞–º–µ—Ä–µ–Ω–∏—è –º–æ–∏ –Ω–µ–ø—Ä–µ–∫–ª–æ–Ω–Ω—ã",
            "character": "Jiang_Chen", 
            "expected": "–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥"
        }
    ]
    
    for i, case in enumerate(test_cases, 1):
        print(f"\nüìù –¢–ï–°–¢ {i}: {case['expected']}")
        print("-" * 30)
        
        original = case["text"]
        modernized = modernizer.modernize_text(original, case["character"])
        
        print(f"–û—Ä–∏–≥–∏–Ω–∞–ª: {original}")
        print(f"–ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: {modernized}")
        
        # –û—Ü–µ–Ω–∫–∞ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
        scores = modernizer.calculate_readability_score(modernized)
        print(f"–ß–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: {scores['readability_score']:.1f}/100")
        print(f"–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: {scores['avg_sentence_length']:.1f} —Å–ª–æ–≤")
        print(f"–ê—Ä—Ö–∞–∏–∑–º–æ–≤: {scores['archaism_count']}")

if __name__ == "__main__":
    test_style_modernizer()
